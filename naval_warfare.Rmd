---
title: "A Markoff chain approach to naval warfare"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library("hyper2")
library("partitions")
library("pdftools")
```

<p style="text-align: right;">
![](`r system.file("help/figures/hyper2.png", package = "hyper2")`){width=10%}
</p>

OK

```{r dosomef,cache=TRUE}
f <- function(a,b){
  if(a==0){return(0)}
  if(b==0){return(1)}
  if(a==b){return(1/2)}
  p <- a/(a+b)
  return(p*f(a,b-1) + (1-p)*f(a-1,b))
}

f(3,2) - 31/40
f(4,2) - 331/360
f(4,3) - 233/315
f(6,6)
f(6,7)
f(10,11)
```



```{tikz, fig.cap = "Partial probability tree for five competitors $a-e$ with $a$ supporting $b$, hyper3 approach", fig.ext = 'png', echo=FALSE}
\usetikzlibrary{arrows}
\usetikzlibrary{arrows.meta}
\usetikzlibrary{patterns}
\newcommand{\arrowIn}{
\tikz \draw[-{Latex[length=4mm]}] (-1pt,0) -- (1pt,0);
}

\begin{tikzpicture}[line cap=round,line join=round,>=triangle 45,x=3cm,y=3cm]

%\fill (0,0) circle[radius=4pt];  % the origin
\fill (1,0) circle[radius=6pt];
\fill (2,0) circle[radius=6pt];
\fill (3,0) circle[radius=6pt];
\fill (4,0) circle[radius=6pt];

\fill (0,1) circle[radius=6pt];
\fill (1,1) circle[radius=3pt];
\fill (2,1) circle[radius=3pt];
\fill (3,1) circle[radius=3pt];
\fill (4,1) circle[radius=3pt];

\fill (0,2) circle[radius=6pt];
\fill (1,2) circle[radius=2pt];
\fill (2,2) circle[radius=2pt];
\fill (3,2) circle[radius=2pt];
\fill (4,2) circle[radius=2pt];

\fill (0,3) circle[radius=6pt];
\fill (1,3) circle[radius=2pt];
\fill (2,3) circle[radius=2pt];
\fill (3,3) circle[radius=2pt];
\fill (4,3) circle[radius=2pt];

% horizontal lines first:

%\draw[line width=0.5mm] (1,0) -- (0,0) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
%\draw[line width=0.5mm] (2,0) -- (1,0) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
%\draw[line width=0.5mm] (3,0) -- (2,0) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
%\draw[line width=0.5mm] (4,0) -- (3,0) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;

\draw[line width=0.5mm] (1,1) -- (0,1) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] (2,1) -- (1,1) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] (3,1) -- (2,1) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] (4,1) -- (3,1) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;

\draw[line width=0.5mm] (1,2) -- (0,2) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] (2,2) -- (1,2) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] (3,2) -- (2,2) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] (4,2) -- (3,2) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;

\draw[line width=0.5mm] (1,3) -- (0,3) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] (2,3) -- (1,3) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] (3,3) -- (2,3) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] (4,3) -- (3,3) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;


% Now vertical lines:
%\draw[line width=0.5mm] (0,1) -- (0,0) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
%\draw[line width=0.5mm] (0,2) -- (0,1) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
%\draw[line width=0.5mm] (0,3) -- (0,2) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;

\draw[line width=0.5mm] (1,1) -- (1,0) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] (1,2) -- (1,1) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] (1,3) -- (1,2) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;

\draw[line width=0.5mm] (2,1) -- (2,0) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] (2,2) -- (2,1) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] (2,3) -- (2,2) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;

\draw[line width=0.5mm] (3,1) -- (3,0) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] (3,2) -- (3,1) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] (3,3) -- (3,2) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;

\draw[line width=0.5mm] (4,1) -- (4,0) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] (4,2) -- (4,1) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] (4,3) -- (4,2) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;


%\node at (0.2, 0.1)  {$(0,0)$};
\node[text=blue] at (1.2, 0.1)  {$(1,0)$};
\node[text=blue] at (2.2, 0.1)  {$(2,0)$};
\node[text=blue] at (3.2, 0.1)  {$(3,0)$};
\node[text=blue] at (4.2, 0.1)  {$(4,0)$};

\node[text=blue] at (0.2, 1.1)  {$(0,1)$};
\node[text=blue] at (1.2, 1.1)  {$(1,1)$};
\node[text=blue] at (2.2, 1.1)  {$(2,1)$};
\node[text=blue] at (3.2, 1.1)  {$(3,1)$};
\node[text=blue] at (4.2, 1.1)  {$(4,1)$};

\node[text=blue] at (0.2, 2.1)  {$(0,2)$};
\node[text=blue] at (1.2, 2.1)  {$(1,2)$};
\node[text=blue] at (2.2, 2.1)  {$(2,2)$};
\node[text=blue] at (3.2, 2.1)  {$(3,2)$};
\node[text=blue] at (4.2, 2.1)  {$(4,2)$};

\node[text=blue] at (0.2, 3.1)  {$(0,3)$};
\node[text=blue] at (1.2, 3.1)  {$(1,3)$};
\node[text=blue] at (2.2, 3.1)  {$(2,3)$};
\node[text=blue] at (3.2, 3.1)  {$(3,3)$};
\node[text=blue] at (4.2, 3.1)  {$(4,3)$};

%  probs for horizontal lines:
\node[text=teal] at (0.5, 0.85)  {$\frac{1}{1+1}$};
\node[text=teal] at (1.5, 0.85)  {$\frac{1}{2+1}$};
\node[text=teal] at (2.5, 0.85)  {$\frac{1}{3+1}$};
\node[text=teal] at (3.5, 0.85)  {$\frac{1}{4+1}$};

\node[text=teal] at (0.5, 1.85)  {$\frac{2}{1+2}$};
\node[text=teal] at (1.5, 1.85)  {$\frac{2}{2+2}$};
\node[text=teal] at (2.5, 1.85)  {$\frac{2}{3+2}$};
\node[text=teal] at (3.5, 1.85)  {$\frac{2}{4+2}$};

\node[text=teal] at (0.5, 2.85)  {$\frac{3}{1+3}$};
\node[text=teal] at (1.5, 2.85)  {$\frac{3}{2+3}$};
\node[text=teal] at (2.5, 2.85)  {$\frac{3}{3+3}$};
\node[text=teal] at (3.5, 2.85)  {$\frac{3}{4+3}$};


%  probs for vertical lines:
\node[text=teal] at (0.85, 0.5)  {$\frac{1}{1+1}$};
\node[text=teal] at (1.85, 0.5)  {$\frac{2}{2+1}$};
\node[text=teal] at (2.85, 0.5)  {$\frac{3}{3+1}$};
\node[text=teal] at (3.85, 0.5)  {$\frac{4}{4+1}$};

\node[text=teal] at (0.85, 1.5)  {$\frac{1}{1+2}$};
\node[text=teal] at (1.85, 1.5)  {$\frac{2}{2+2}$};
\node[text=teal] at (2.85, 1.5)  {$\frac{3}{3+2}$};
\node[text=teal] at (3.85, 1.5)  {$\frac{4}{4+2}$};

\node[text=teal] at (0.85, 2.5)  {$\frac{1}{1+3}$};
\node[text=teal] at (1.85, 2.5)  {$\frac{2}{2+3}$};
\node[text=teal] at (2.85, 2.5)  {$\frac{3}{3+3}$};
\node[text=teal] at (3.85, 2.5)  {$\frac{4}{4+3}$};

% win probabilities


\node[text=red] at ( 0.8, 0.1)  {$1$};
\node[text=red] at ( 1.8, 0.1)  {$1$};
\node[text=red] at ( 2.8, 0.1)  {$1$};
\node[text=red] at ( 3.8, 0.1)  {$1$};

\node[text=red] at (-0.2, 1.1)  {$0$};
\node[text=red] at ( 0.8, 1.1)  {$\frac{1}{2}$};
\node[text=red] at ( 1.8, 1.1)  {$\frac{5}{6}$};
\node[text=red] at ( 2.8, 1.1)  {$\frac{23}{24}$};
\node[text=red] at ( 3.8, 1.1)  {$\frac{119}{120}$};

\node[text=red] at (-0.2, 2.1)  {$0$};
\node[text=red] at ( 0.8, 2.1)  {$\frac{1}{6}$};
\node[text=red] at ( 1.8, 2.1)  {$\frac{1}{2}$};
\node[text=red] at ( 2.8, 2.1)  {$\frac{31}{40}$};
\node[text=red] at ( 3.8, 2.1)  {$\frac{331}{360}$};

\node[text=red] at (-0.2, 3.1)  {$0$};
\node[text=red] at ( 0.8, 3.1)  {$\frac{1}{24}$};
\node[text=red] at ( 1.8, 3.1)  {$\frac{19}{40}$};
\node[text=red] at ( 2.8, 3.1)  {$\frac{1}{2}$};
\node[text=red] at ( 3.8, 3.1)  {$\frac{233}{315}$};



\end{tikzpicture}
```


$$P(a,b) =
\frac{a}{a+b}P(a,b-1) + \frac{b}{a+b}P(a-1,b)\qquad a,b>0$$

$$P(a,0)=1,a\geqslant 1,
P(0,b)=0,b\geqslant 1
$$




```{tikz, fig.cap = "Partial probability tree for naval warfare", fig.ext = 'png', echo=FALSE}
\usetikzlibrary{arrows}
\usetikzlibrary{arrows.meta}
\usetikzlibrary{patterns}
\newcommand{\arrowIn}{
\tikz \draw[-{Latex[length=4mm]}] (-1pt,0) -- (1pt,0);
}

\begin{tikzpicture}[line cap=round,line join=round,>=triangle 45,x=3cm,y=3cm]

%\fill (0,0) circle[radius=4pt];  % the origin
\fill (1,0) circle[radius=6pt];
\fill (2,0) circle[radius=6pt];
\fill (3,0) circle[radius=6pt];
\fill (4,0) circle[radius=6pt];

\fill (0,1) circle[radius=6pt];
\fill (1,1) circle[radius=3pt];
\fill (2,1) circle[radius=3pt];
\fill (3,1) circle[radius=3pt];
\fill (4,1) circle[radius=3pt];

\fill (0,2) circle[radius=6pt];
\fill (1,2) circle[radius=2pt];
\fill (2,2) circle[radius=2pt];
\fill (3,2) circle[radius=2pt];
\fill (4,2) circle[radius=2pt];

\fill (0,3) circle[radius=6pt];
\fill (1,3) circle[radius=2pt];
\fill (2,3) circle[radius=2pt];
\fill (3,3) circle[radius=2pt];
\fill (4,3) circle[radius=2pt];


% horizontal lines first:

%\draw[line width=0.5mm] (1,0) -- (0,0) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
%\draw[line width=0.5mm] (2,0) -- (1,0) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
%\draw[line width=0.5mm] (3,0) -- (2,0) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
%\draw[line width=0.5mm] (4,0) -- (3,0) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;

\draw[line width=0.5mm] (1,1) -- (0,1) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] (2,1) -- (1,1) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] (3,1) -- (2,1) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] (4,1) -- (3,1) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;

\draw[line width=0.5mm] (1,2) -- (0,2) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] (2,2) -- (1,2) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] (3,2) -- (2,2) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] (4,2) -- (3,2) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;

\draw[line width=0.5mm] (1,3) -- (0,3) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] (2,3) -- (1,3) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] (3,3) -- (2,3) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] (4,3) -- (3,3) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;


% Now vertical lines:
%\draw[line width=0.5mm] (0,1) -- (0,0) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
%\draw[line width=0.5mm] (0,2) -- (0,1) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
%\draw[line width=0.5mm] (0,3) -- (0,2) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;

\draw[line width=0.5mm] (1,1) -- (1,0) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] (1,2) -- (1,1) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] (1,3) -- (1,2) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;

\draw[line width=0.5mm] (2,1) -- (2,0) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] (2,2) -- (2,1) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] (2,3) -- (2,2) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;

\draw[line width=0.5mm] (3,1) -- (3,0) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] (3,2) -- (3,1) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] (3,3) -- (3,2) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;

\draw[line width=0.5mm] (4,1) -- (4,0) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] (4,2) -- (4,1) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] (4,3) -- (4,2) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;


%\node at (0.2, 0.1)  {$(0,0)$};
\node[text=blue] at (1.2, 0.1)  {$(1,0)$};
\node[text=blue] at (2.2, 0.1)  {$(2,0)$};
\node[text=blue] at (3.2, 0.1)  {$(3,0)$};
\node[text=blue] at (4.2, 0.1)  {$(4,0)$};

\node[text=blue] at (0.2, 1.1)  {$(0,1)$};
\node[text=blue] at (1.2, 1.1)  {$(1,1)$};
\node[text=blue] at (2.2, 1.1)  {$(2,1)$};
\node[text=blue] at (3.2, 1.1)  {$(3,1)$};
\node[text=blue] at (4.2, 1.1)  {$(4,1)$};

\node[text=blue] at (0.2, 2.1)  {$(0,2)$};
\node[text=blue] at (1.2, 2.1)  {$(1,2)$};
\node[text=blue] at (2.2, 2.1)  {$(2,2)$};
\node[text=blue] at (3.2, 2.1)  {$(3,2)$};
\node[text=blue] at (4.2, 2.1)  {$(4,2)$};

\node[text=blue] at (0.2, 3.1)  {$(0,3)$};
\node[text=blue] at (1.2, 3.1)  {$(1,3)$};
\node[text=blue] at (2.2, 3.1)  {$(2,3)$};
\node[text=blue] at (3.2, 3.1)  {$(3,3)$};
\node[text=blue] at (4.2, 3.1)  {$(4,3)$};

%  probs for horizontal lines:
\node[text=teal] at (0.5, 0.85)  {$\frac{1}{2}$};
\node[text=teal] at (1.5, 0.85)  {$\frac{1}{3}$};
\node[text=teal] at (2.5, 0.85)  {$\frac{1}{4}$};
\node[text=teal] at (3.5, 0.85)  {$\frac{1}{5}$};

\node[text=teal] at (0.5, 1.85)  {$\frac{2}{3}$};
\node[text=teal] at (1.5, 1.85)  {$\frac{2}{4}$};
\node[text=teal] at (2.5, 1.85)  {$\frac{2}{5}$};
\node[text=teal] at (3.5, 1.85)  {$\frac{2}{6}$};

\node[text=teal] at (0.5, 2.85)  {$\frac{3}{4}$};
\node[text=teal] at (1.5, 2.85)  {$\frac{3}{5}$};
\node[text=teal] at (2.5, 2.85)  {$\frac{3}{6}$};
\node[text=teal] at (3.5, 2.85)  {$\frac{3}{7}$};


%  probs for vertical lines:
\node[text=teal] at (0.85, 0.5)  {$\frac{1}{2}$};
\node[text=teal] at (1.85, 0.5)  {$\frac{2}{3}$};
\node[text=teal] at (2.85, 0.5)  {$\frac{3}{4}$};
\node[text=teal] at (3.85, 0.5)  {$\frac{4}{5}$};

\node[text=teal] at (0.85, 1.5)  {$\frac{1}{3}$};
\node[text=teal] at (1.85, 1.5)  {$\frac{2}{4}$};
\node[text=teal] at (2.85, 1.5)  {$\frac{3}{5}$};
\node[text=teal] at (3.85, 1.5)  {$\frac{4}{6}$};

\node[text=teal] at (0.85, 2.5)  {$\frac{1}{4}$};
\node[text=teal] at (1.85, 2.5)  {$\frac{2}{5}$};
\node[text=teal] at (2.85, 2.5)  {$\frac{3}{6}$};
\node[text=teal] at (3.85, 2.5)  {$\frac{4}{7}$};

% win probabilities


\node[text=red] at ( 0.8, 0.1)  {$1$};
\node[text=red] at ( 1.8, 0.1)  {$1$};
\node[text=red] at ( 2.8, 0.1)  {$1$};
\node[text=red] at ( 3.8, 0.1)  {$1$};

\node[text=red] at (-0.2, 1.1)  {$0$};
\node[text=red] at ( 0.8, 1.1)  {$\frac{1}{2}$};
\node[text=red] at ( 1.8, 1.1)  {$\frac{5}{6}$};
\node[text=red] at ( 2.8, 1.1)  {$\frac{23}{24}$};
\node[text=red] at ( 3.8, 1.1)  {$\frac{119}{120}$};

\node[text=red] at (-0.2, 2.1)  {$0$};
\node[text=red] at ( 0.8, 2.1)  {$\frac{1}{6}$};
\node[text=red] at ( 1.8, 2.1)  {$\frac{1}{2}$};
\node[text=red] at ( 2.8, 2.1)  {$\frac{31}{40}$};
\node[text=red] at ( 3.8, 2.1)  {$\frac{331}{360}$};

\node[text=red] at (-0.2, 3.1)  {$0$};
\node[text=red] at ( 0.8, 3.1)  {$\frac{1}{24}$};
\node[text=red] at ( 1.8, 3.1)  {$\frac{19}{40}$};
\node[text=red] at ( 2.8, 3.1)  {$\frac{1}{2}$};
\node[text=red] at ( 3.8, 3.1)  {$\frac{233}{315}$};



\end{tikzpicture}
```

```{tikz, fig.cap = "more than two behind means you have lost with probability 1", fig.ext = 'png', echo=FALSE}
\usetikzlibrary{arrows}
\usetikzlibrary{arrows.meta}
\usetikzlibrary{patterns}
\newcommand{\arrowIn}{
\tikz \draw[-{Latex[length=4mm]}] (-1pt,0) -- (1pt,0);
}
\newcommand{\half}{$\frac{1}{2}$}

\begin{tikzpicture}[line cap=round,line join=round,>=triangle 45,x=3cm,y=3cm]


\draw[line width=0.5mm] (0,1) -- ( 1,0) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] (0,1) -- (-1,0) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\fill ( 0,1) circle[radius=2pt];
\fill ( 1,0) circle[radius=6pt];
\fill (-1,0) circle[radius=6pt];
\node[text=blue] at (-0.75,0  ) {$(1,0)$};
\node[text=blue] at ( 0.75,0  ) {$(0,1)$};
\node[text=red ] at (-1.0, 0.2)  {$0$};
\node[text=red ] at ( 1.0, 0.2)  {$1$};
\node[text=teal] at (-0.5, 0.7) {\half};
\node[text=teal] at ( 0.5, 0.7) {\half};
\node[text=blue] at ( 0  , 0.8) {$(1,1)$};

\draw[line width=0.5mm] ( 1,2) -- ( 0,1) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] ( 1,2) -- ( 2,1) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] (-1,2) -- ( 0,1) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] (-1,2) -- (-2,1) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] ( 0,3) -- ( 1,2) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] ( 0,3) -- (-1,2) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\fill (-2,1) circle[radius=6pt];
\fill ( 2,1) circle[radius=6pt];
\fill (-1,2) circle[radius=2pt];
\fill ( 1,2) circle[radius=2pt];
\fill ( 0,3) circle[radius=2pt];
\node[text=red ] at (-2   , 1.2) {$0$};
\node[text=red ] at (-1   , 2.2) {$\frac{1}{6}$};
\node[text=red ] at ( 0   , 1.2) {\half};
\node[text=red ] at ( 1   , 2.2) {$\frac{5}{6}$};
\node[text=red ] at ( 2   , 1.2) {$1$};
\node[text=blue] at (-1.75, 1.0) {$(2,0)$};
\node[text=blue] at (-1   , 1.8) {$(2,1)$};
\node[text=blue] at ( 0.0 , 2.8) {$(2,2)$};
\node[text=blue] at ( 1   , 1.8) {$(1,2)$};
\node[text=blue] at ( 1.75, 1.0) {$(0,2)$};
\node[text=teal] at (-1.5 , 1.7) {$\frac{2}{3}$};
\node[text=teal] at (-0.5 , 1.7) {$\frac{1}{3}$};
\node[text=teal] at ( 0.5 , 1.7) {$\frac{1}{3}$};
\node[text=teal] at ( 1.5 , 1.7) {$\frac{2}{3}$};
\node[text=teal] at (-0.5 , 2.7) {\half};
\node[text=teal] at ( 0.5 , 2.7) {\half};




\draw[line width=0.5mm] ( 1,4) -- ( 0,3) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] ( 1,4) -- ( 2,3) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] (-1,4) -- ( 0,3) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] (-1,4) -- (-2,3) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] ( 0,5) -- ( 1,4) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] ( 0,5) -- (-1,4) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\fill (-2,3) circle[radius=6pt];
\fill ( 2,3) circle[radius=6pt];
\fill (-1,4) circle[radius=2pt];
\fill ( 1,4) circle[radius=2pt];
\fill ( 0,5) circle[radius=2pt];
\node[text=blue] at (-1.75, 3.0) {$(3,1)$};
\node[text=blue] at ( 1.75, 3.0) {$(1,3)$};
\node[text=red ] at (-2   , 3.2) {$0$};
\node[text=red ] at ( 0   , 3.2) {\half};
\node[text=red ] at ( 2   , 3.2) {$1$};
\node[text=red ] at (-1   , 4.2) {$\frac{1}{5}$};
\node[text=red ] at ( 1   , 4.2) {$\frac{4}{5}$};
\node[text=teal] at (-1.5 , 3.7) {$\frac{3}{5}$};
\node[text=teal] at (-0.5 , 3.7) {$\frac{2}{5}$};
\node[text=teal] at ( 0.5 , 3.7) {$\frac{2}{5}$};
\node[text=teal] at ( 1.5 , 3.7) {$\frac{3}{5}$};
\node[text=blue] at (-1   , 3.8) {$(3,2)$};
\node[text=blue] at ( 1   , 3.8) {$(2,3)$};
\node[text=teal] at (-0.5 , 4.7) {\half};
\node[text=teal] at ( 0.5 , 4.7) {\half};
\node[text=blue] at ( 0.0 , 4.8) {$(3,3)$};


\draw[line width=0.5mm] ( 1,6) -- ( 0,5) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] ( 1,6) -- ( 2,5) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] (-1,6) -- ( 0,5) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] (-1,6) -- (-2,5) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] ( 0,7) -- ( 1,6) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] ( 0,7) -- (-1,6) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\fill (-2,5) circle[radius=6pt];
\fill ( 2,5) circle[radius=6pt];
\fill (-1,6) circle[radius=2pt];
\fill ( 1,6) circle[radius=2pt];
\fill ( 0,7) circle[radius=2pt];
\node[text=red ] at (-2   , 5.2) {$0$};
\node[text=red ] at ( 0   , 5.2) {\half};
\node[text=red ] at ( 2   , 5.2) {$1$};
\node[text=red ] at (-1   , 6.2) {$\frac{3}{14}$};
\node[text=red ] at ( 1   , 6.2) {$\frac{11}{14}$};

\node[text=blue] at (-1.75, 5.0) {$(4,2)$};
\node[text=blue] at ( 1.75, 5.0) {$(2,4)$};
\node[text=teal] at (-1.5 , 5.7) {$\frac{4}{7}$};
\node[text=teal] at (-0.5 , 5.7) {$\frac{3}{7}$};
\node[text=teal] at ( 0.5 , 5.7) {$\frac{3}{7}$};
\node[text=teal] at ( 1.5 , 5.7) {$\frac{4}{7}$};
\node[text=blue] at (-1   , 5.8) {$(4,3)$};
\node[text=blue] at ( 1   , 5.8) {$(3,4)$};
\node[text=teal] at (-0.5 , 6.7) {\half};
\node[text=teal] at ( 0.5 , 6.7) {\half};
\node[text=blue] at ( 0.0 , 6.8) {$(4,4)$};


\end{tikzpicture}
```

```{tikz, fig.cap = "more than _two_ behind means you have lost with probability 1, single rep unit", fig.ext = 'png', echo=FALSE}
\usetikzlibrary{arrows}
\usetikzlibrary{arrows.meta}
\usetikzlibrary{patterns}
\newcommand{\arrowIn}{\tikz \draw[-{Latex[length=4mm]}] (-1pt,0) -- (1pt,0);}
\newcommand{\half}{$\frac{1}{2}$}

\begin{tikzpicture}[line cap=round,line join=round,>=triangle 45,x=3cm,y=3cm]


\draw[line width=0.5mm] ( 1,2) -- ( 0,1) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] ( 1,2) -- ( 2,1) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] (-1,2) -- ( 0,1) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] (-1,2) -- (-2,1) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] ( 0,3) -- ( 1,2) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] ( 0,3) -- (-1,2) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\fill (-2,1) circle[radius=6pt];
\fill ( 2,1) circle[radius=6pt];
\fill (-1,2) circle[radius=2pt];
\fill ( 1,2) circle[radius=2pt];
\fill ( 0,3) circle[radius=2pt];
\fill ( 0,1) circle[radius=2pt];
\node[text=red ] at ( 2   , 1.2) {$1$};
\node[text=red ] at (-2   , 1.2) {$0$};
\node[text=red ] at ( 0   , 1.2) {\half};
\node[text=red ] at ( 1   , 2.2) {$\frac{3a-1}{4a-2}$};
\node[text=red ] at (-1   , 2.2) {$\frac{a-1}{4a-2}$};
\node[text=teal] at (-0.5 , 1.7) {$\frac{a-1}{2a-1}$};
\node[text=teal] at ( 0.5 , 1.7) {$\frac{a-1}{2a-1}$};
\node[text=teal] at (-1.5 , 1.7) {$\frac{a}{2a-1}$};
\node[text=teal] at ( 1.5 , 1.7) {$\frac{a}{2a-1}$};
\node[text=blue] at (-1.6 , 1.0) {$(a,a-2)$};
\node[text=blue] at ( 1.6 , 1.0) {$(a-2,a)$};
\node[text=blue] at (-1   , 1.7) {$(a,a-1)$};
\node[text=blue] at ( 1   , 1.7) {$(a-1,a)$};
\node[text=teal] at (-0.5 , 2.7) {\half};
\node[text=teal] at ( 0.5 , 2.7) {\half};
\node[text=blue] at ( 0.0 , 2.8) {$(a,a)$};
\node[text=blue] at ( 0.0 , 0.9){$(a-2,a)$};

\end{tikzpicture}
```


```{tikz, fig.cap = "more than _three_ behind means you have lost with probability 1, single rep unit", fig.ext = 'png', echo=FALSE}
\usetikzlibrary{arrows}
\usetikzlibrary{arrows.meta}
\usetikzlibrary{patterns}
\newcommand{\arrowIn}{\tikz \draw[-{Latex[length=4mm]}] (-1pt,0) -- (1pt,0);}
\newcommand{\half}{$\frac{1}{2}$}

\begin{tikzpicture}[line cap=round,line join=round,>=triangle 45,x=3cm,y=3cm]


\draw[line width=0.5mm] ( 1,2) -- ( 0,1) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] ( 1,2) -- ( 2,1) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] (-1,2) -- ( 0,1) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] (-1,2) -- (-2,1) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] ( 0,3) -- ( 1,2) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] ( 0,3) -- (-1,2) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] (-2,1) -- (-3,0) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] (-2,1) -- (-1,0) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] ( 2,1) -- ( 3,0) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] ( 2,1) -- ( 1,0) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] ( 0,1) -- (-1,0) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] ( 0,1) -- ( 1,0) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;

\fill (-3,0) circle[radius=6pt];
\fill (-1,0) circle[radius=2pt];
\fill ( 1,0) circle[radius=2pt];
\fill ( 3,0) circle[radius=6pt];
\fill (-2,1) circle[radius=2pt];
\fill ( 0,1) circle[radius=2pt];
\fill ( 2,1) circle[radius=2pt];
\fill (-1,2) circle[radius=2pt];
\fill ( 1,2) circle[radius=2pt];
\fill ( 0,3) circle[radius=2pt];

\node[text=red ] at (-3 , 0.2) {$0$};
\node[text=red ] at ( 3 , 0.2) {$1$};
\node[text=red ] at (-2 , 1.2) {$\frac{xx}{xx}$};
\node[text=red ] at ( 0 , 1.2) {\half};
\node[text=red ] at ( 2 , 1.2) {$\frac{xx}{xx}$};
\node[text=red ] at (-1 , 2.2) {$\frac{xx}{xx}$};
\node[text=red ] at ( 1 , 2.2) {$\frac{xx}{xx}$};

\node[text=teal] at (-0.5 , 1.7) {$\frac{a-1}{2a-1}$};
\node[text=teal] at ( 0.5 , 1.7) {$\frac{a-1}{2a-1}$};
\node[text=teal] at (-1.5 , 1.7) {$\frac{a  }{2a-1}$};
\node[text=teal] at ( 1.5 , 1.7) {$\frac{a  }{2a-1}$};
\node[text=teal] at (-1.5 , 0.7) {$\frac{a-2}{2a-2}$};
\node[text=teal] at ( 1.5 , 0.7) {$\frac{a  }{2a-2}$};
\node[text=teal] at (-2.5 , 0.7) {$\frac{a  }{2a-2}$};
\node[text=teal] at ( 2.5 , 0.7) {$\frac{a-2}{2a-2}$};
\node[text=teal] at (-0.5 , 2.7) {\half};
\node[text=teal] at ( 0.5 , 2.7) {\half};
\node[text=teal] at (-0.5 , 0.7) {\half};
\node[text=teal] at ( 0.5 , 0.7) {\half};

\node[text=blue] at (-3 ,-0.2) {$(a  ,a-3)$};
\node[text=blue] at (-1 ,-0.2) {$(a-1,a-2)$};
\node[text=blue] at ( 1 ,-0.2) {$(a-2,a-1)$};
\node[text=blue] at ( 3 ,-0.2) {$(a-3,a  )$};
\node[text=blue] at ( 0 , 0.6) {$(a-1,a-1)$};
\node[text=blue] at (-2 , 0.7) {$(a  ,a-2)$};
\node[text=blue] at (-1 , 1.7) {$(a  ,a-1)$};
\node[text=blue] at ( 1 , 1.7) {$(a-1,a  )$};
\node[text=blue] at ( 2 , 0.7) {$(a-2,a  )$};
\node[text=blue] at ( 0 , 2.8) {$(a  ,a  )$};

\end{tikzpicture}
```





```{tikz, fig.cap = "Behind by three or more means you have lost with probability 1, start at $(4,4)$", fig.ext = 'png', echo=FALSE}
\usetikzlibrary{arrows}
\usetikzlibrary{arrows.meta}
\usetikzlibrary{patterns}
\newcommand{\arrowIn}{
\tikz \draw[-{Latex[length=4mm]}] (-1pt,0) -- (1pt,0);
}
\newcommand{\half}{$\frac{1}{2}$}

\begin{tikzpicture}[line cap=round,line join=round,>=triangle 45,x=3cm,y=3cm]


\draw[line width=0.5mm] ( 0,1) -- ( 1,0) node[sloped, pos=0.5, allow upside down]{\arrowIn}; 
\draw[line width=0.5mm] ( 0,1) -- (-1,0) node[sloped, pos=0.5, allow upside down]{\arrowIn}; 
\draw[line width=0.5mm] ( 1,2) -- ( 0,1) node[sloped, pos=0.5, allow upside down]{\arrowIn}; 
\draw[line width=0.5mm] ( 1,2) -- ( 2,1) node[sloped, pos=0.5, allow upside down]{\arrowIn}; 
\draw[line width=0.5mm] (-1,2) -- ( 0,1) node[sloped, pos=0.5, allow upside down]{\arrowIn}; 
\draw[line width=0.5mm] (-1,2) -- (-2,1) node[sloped, pos=0.5, allow upside down]{\arrowIn}; 
\draw[line width=0.5mm] ( 0,3) -- ( 1,2) node[sloped, pos=0.5, allow upside down]{\arrowIn}; 
\draw[line width=0.5mm] ( 0,3) -- (-1,2) node[sloped, pos=0.5, allow upside down]{\arrowIn}; 
\draw[line width=0.5mm] ( 1,4) -- ( 0,3) node[sloped, pos=0.5, allow upside down]{\arrowIn}; 
\draw[line width=0.5mm] ( 1,4) -- ( 2,3) node[sloped, pos=0.5, allow upside down]{\arrowIn}; 
\draw[line width=0.5mm] (-1,4) -- ( 0,3) node[sloped, pos=0.5, allow upside down]{\arrowIn}; 
\draw[line width=0.5mm] (-1,4) -- (-2,3) node[sloped, pos=0.5, allow upside down]{\arrowIn}; 
\draw[line width=0.5mm] ( 0,5) -- ( 1,4) node[sloped, pos=0.5, allow upside down]{\arrowIn}; 
\draw[line width=0.5mm] ( 0,5) -- (-1,4) node[sloped, pos=0.5, allow upside down]{\arrowIn}; 
\draw[line width=0.5mm] ( 2,5) -- ( 3,4) node[sloped, pos=0.5, allow upside down]{\arrowIn}; 
\draw[line width=0.5mm] (-2,5) -- (-3,4) node[sloped, pos=0.5, allow upside down]{\arrowIn}; 
\draw[line width=0.5mm] ( 2,5) -- ( 1,4) node[sloped, pos=0.5, allow upside down]{\arrowIn}; 
\draw[line width=0.5mm] (-2,5) -- (-1,4) node[sloped, pos=0.5, allow upside down]{\arrowIn}; 
\draw[line width=0.5mm] ( 2,3) -- ( 1,2) node[sloped, pos=0.5, allow upside down]{\arrowIn}; 
\draw[line width=0.5mm] (-2,3) -- (-1,2) node[sloped, pos=0.5, allow upside down]{\arrowIn}; 
\draw[line width=0.5mm] ( 2,3) -- ( 3,2) node[sloped, pos=0.5, allow upside down]{\arrowIn}; 
\draw[line width=0.5mm] (-2,3) -- (-3,2) node[sloped, pos=0.5, allow upside down]{\arrowIn}; 
\draw[line width=0.5mm] ( 1,6) -- ( 0,5) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] ( 1,6) -- ( 2,5) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] (-1,6) -- ( 0,5) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] (-1,6) -- (-2,5) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] ( 0,7) -- ( 1,6) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;
\draw[line width=0.5mm] ( 0,7) -- (-1,6) node[sloped, pos=0.5, allow upside down]{\arrowIn}; ;

\node[text=red ] at (-1.0 , 0.2) {$0$};
\node[text=red ] at ( 1.0 , 0.2) {$1$};
\node[text=red ] at (-2   , 1.2) {$0$};
\node[text=red ] at ( 0   , 1.2) {\half};
\node[text=red ] at ( 2   , 1.2) {$1$};
\node[text=red ] at (-3   , 2.2) {$0$};
\node[text=red ] at (-1   , 2.2) {$\frac{1}{6}$};
\node[text=red ] at ( 1   , 2.2) {$\frac{5}{6}$};
\node[text=red ] at ( 3   , 2.2) {$1$};
\node[text=red ] at (-2.0 , 3.2) {$\frac{1}{24}$};
\node[text=red ] at ( 2.0 , 3.2) {$\frac{23}{24}$};
\node[text=red ] at ( 0   , 3.2) {\half};
\node[text=red ] at (-3   , 4.2) {$0$};
\node[text=red ] at (-1   , 4.2) {$\frac{9}{40}$};
\node[text=red ] at ( 1   , 4.2) {$\frac{31}{40}$};
\node[text=red ] at ( 3   , 4.2) {$1$};
\node[text=red ] at (-2   , 5.2) {$\frac{3}{40}$};
\node[text=red ] at ( 0   , 5.2) {\half};
\node[text=red ] at ( 2   , 5.2) {$\frac{37}{40}$};
\node[text=red ] at (-1   , 6.2) {$\frac{9}{35}$};
\node[text=red ] at ( 1   , 6.2) {$\frac{26}{35}$};

\node[text=blue] at (-0.75, 0  ) {$(1,0)$};
\node[text=blue] at ( 0.75, 0  ) {$(0,1)$};
\node[text=blue] at (-1.75, 5.0) {$(4,2)$};
\node[text=blue] at ( 1.75, 5.0) {$(2,4)$};
\node[text=blue] at ( 0  ,  0.8) {$(1,1)$};
\node[text=blue] at (-1   , 5.8) {$(4,3)$};
\node[text=blue] at ( 1   , 5.8) {$(3,4)$};
\node[text=blue] at ( 0.0 , 6.8) {$(4,4)$};
\node[text=blue] at (-1.75, 1.0) {$(2,0)$};
\node[text=blue] at (-1   , 1.8) {$(2,1)$};
\node[text=blue] at ( 0.0 , 2.8) {$(2,2)$};
\node[text=blue] at ( 1   , 1.8) {$(1,2)$};
\node[text=blue] at ( 1.75, 1.0) {$(0,2)$};
\node[text=blue] at (-1.75, 3.0) {$(3,1)$};
\node[text=blue] at ( 1.75, 3.0) {$(1,3)$};
\node[text=blue] at (-1   , 3.8) {$(3,2)$};
\node[text=blue] at ( 1   , 3.8) {$(2,3)$};
\node[text=blue] at ( 0.0 , 4.8) {$(3,3)$};
\node[text=teal] at (-1.5 , 5.7) {$\frac{4}{7}$};
\node[text=teal] at (-0.5 , 5.7) {$\frac{3}{7}$};
\node[text=teal] at ( 0.5 , 5.7) {$\frac{3}{7}$};
\node[text=teal] at ( 1.5 , 5.7) {$\frac{4}{7}$};
\node[text=teal] at (-0.5 , 6.7) {\half};
\node[text=teal] at ( 0.5 , 6.7) {\half};
\node[text=teal] at (-0.5 , 0.7) {\half};
\node[text=teal] at ( 0.5 , 0.7) {\half};
\node[text=teal] at (-1.5 , 1.7) {$\frac{2}{3}$};
\node[text=teal] at (-0.5 , 1.7) {$\frac{1}{3}$};
\node[text=teal] at ( 0.5 , 1.7) {$\frac{1}{3}$};
\node[text=teal] at ( 1.5 , 1.7) {$\frac{2}{3}$};
\node[text=teal] at (-0.5 , 2.7) {\half};
\node[text=teal] at ( 0.5 , 2.7) {\half};
\node[text=teal] at (-1.5 , 2.7) {$\frac{3}{4}$};
\node[text=teal] at ( 1.5 , 2.7) {$\frac{1}{4}$};
\node[text=teal] at (-2.5 , 2.7) {$\frac{3}{4}$};
\node[text=teal] at ( 2.5 , 2.7) {$\frac{3}{4}$};
\node[text=teal] at (-1.5 , 3.7) {$\frac{3}{5}$};
\node[text=teal] at (-0.5 , 3.7) {$\frac{2}{5}$};
\node[text=teal] at ( 0.5 , 3.7) {$\frac{2}{5}$};
\node[text=teal] at ( 1.5 , 3.7) {$\frac{3}{5}$};

\node[text=teal] at (-2.5 , 4.7) {$\frac{4}{6}$};
\node[text=teal] at (-1.5 , 4.7) {$\frac{2}{6}$};
\node[text=teal] at (-0.5 , 4.7) {\half};
\node[text=teal] at ( 0.5 , 4.7) {\half};
\node[text=teal] at ( 1.5 , 4.7) {$\frac{2}{6}$};
\node[text=teal] at ( 2.5 , 4.7) {$\frac{4}{6}$};


\fill ( 1,0) circle[radius=6pt];
\fill (-1,0) circle[radius=6pt];
\fill (-2,1) circle[radius=6pt];
\fill ( 0,1) circle[radius=2pt];
\fill ( 2,1) circle[radius=6pt];
\fill (-3,2) circle[radius=6pt];
\fill (-1,2) circle[radius=2pt];
\fill ( 1,2) circle[radius=2pt];
\fill ( 3,2) circle[radius=6pt];
\fill (-2,3) circle[radius=2pt];
\fill ( 0,3) circle[radius=2pt];
\fill ( 2,3) circle[radius=2pt];
\fill (-3,4) circle[radius=6pt];
\fill (-1,4) circle[radius=2pt];
\fill ( 1,4) circle[radius=2pt];
\fill ( 3,4) circle[radius=6pt];
\fill (-2,5) circle[radius=2pt];
\fill ( 0,5) circle[radius=2pt];
\fill ( 2,5) circle[radius=2pt];
\fill (-1,6) circle[radius=2pt];
\fill ( 1,6) circle[radius=2pt];
\fill ( 0,7) circle[radius=2pt];


\end{tikzpicture}
```

```{tikz, fig.cap = "behind by three or more means losing with probability 1, single rep unit for recurrence relation", fig.ext = 'png', echo=FALSE}
\usetikzlibrary{arrows}
\usetikzlibrary{arrows.meta}
\usetikzlibrary{patterns}
\newcommand{\arrowIn}{
\tikz \draw[-{Latex[length=4mm]}] (-1pt,0) -- (1pt,0);
}
\newcommand{\half}{$\frac{1}{2}$}

\begin{tikzpicture}[line cap=round,line join=round,>=triangle 45,x=3cm,y=3cm]

\draw[line width=0.5mm] ( 1,1) -- ( 0,0) node[sloped, pos=0.5, allow upside down]{\arrowIn}; 
\draw[line width=0.5mm] (-1,1) -- ( 0,0) node[sloped, pos=0.5, allow upside down]{\arrowIn}; 
\draw[line width=0.5mm] ( 0,2) -- ( 1,1) node[sloped, pos=0.5, allow upside down]{\arrowIn}; 
\draw[line width=0.5mm] ( 0,2) -- (-1,1) node[sloped, pos=0.5, allow upside down]{\arrowIn}; 
\draw[line width=0.5mm] ( 1,1) -- ( 2,0) node[sloped, pos=0.5, allow upside down]{\arrowIn}; 

\fill ( 0,0) circle[radius=2pt];
\fill (-1,1) circle[radius=2pt];
\fill ( 1,1) circle[radius=2pt];
\fill ( 0,2) circle[radius=2pt];
\fill ( 2,0) circle[radius=6pt];


\node[text=red ] at ( 0   , 0.1) {$x_{n}$};
\node[text=red ] at (-1   , 1.1) {$\frac{1}{2}$};
\node[text=red ] at ( 0   , 2.1) {$x_{n+1}$};
\node[text=red ] at ( 1   , 1.2) {$y$};
\node[text=red ] at ( 2   , 0.2) {$1$};

\node[text=blue] at ( 0  , -0.15) {$(n-1,n)$};
\node[text=blue] at ( 2  , -0.15) {$(n-2,n+1)$};
\node[text=blue] at ( 0  ,  1.6) {$(n,n+1)$};
\node[text=blue] at (-1 ,   0.8) {$(n,n)$};
\node[text=blue] at ( 1 ,   0.6) {$(n-1,n+1)$};

\node[text=teal] at (-0.5 , 1.7) {$\frac{n}{2n+1}$};
\node[text=teal] at ( 0.5 , 1.7) {$\frac{n+1}{2n+1}$};
\node[text=teal] at (-0.5 , 0.7) {$\frac{1}{2}$};
\node[text=teal] at ( 0.5 , 0.7) {$\frac{n-1}{2n}$};
\node[text=teal] at ( 1.5 , 0.7) {$\frac{n+1}{2n}$};


\end{tikzpicture}
```


Above we can set up a recurrence relation:

$$
y = x_n\cdot\frac{n-1}{2n} + 1\cdot\frac{n+1}{2n}
$$

$$
x_{n+1} = \frac{1}{2}\cdot\frac{n}{2n+1} + y\cdot\frac{n+1}{2n+1}
$$

Or altogether

$$
x_{n+1}= x_n\cdot\frac{n^2-1}{4n^2+2n} + \frac{2n^2+2n+1}{4n^2+2n}
$$


To solve these:

```
e = RSolve[{a[n+1] ==a[n]*(n^2-1)/(4*n^2+2*n) + (2*n^2+2*n+1)/(4*n^2+2*n),a[2]==5/6},a[n],n] // FullSimplify 
p = a[n] /. e 
f = p[[1]] 
```

This gives:

```
                                (9 + I Sqrt[3]) Sqrt[Pi]                                     1
       8 - 12 n + Gamma[1 + n] (------------------------ + 2 Hypergeometric2F1Regularized[1, - + n, 2 + n, 4])
                                     n       1                                               2
                                    4  Gamma[- + n]
   1                                         2
 -(--) -------------------------------------------------------------------------------------------------------
   18                                                  -1 + n
```

NB: mathematica sometimes gets its knickers in a twist and gives an
equivalent, but much more complicated (!), result.  You just have to
try repeatedly and say a little prayer.  Using `FullSimplify`
sometimes helps.  Anyway, if the moon is full and the auspices are
favourable you get:

$$
\frac{1}{18(n-1)}
\left(
12n-8- \frac{(9+i\sqrt{3})\sqrt{\pi}\Gamma(n+1)}{4^n\Gamma(n+1/2)}-2\Gamma(n+1)\widetilde{{}_2F_1}(1,n+1/2;n+2;4)
\right)
$$

For some reason mathematica will not simplify further, but by hand
(and with a little bit of help from Milton and Irene) we find:

$$
\frac{1}{18(n-1)}
\left(
12n-8- \frac{(9+i\sqrt{3})\sqrt{\pi}\Gamma(n+1)}{4^n\Gamma(n+1/2)}-\frac{2{}_2F_1(1,n+1/2;n+2;4)}{n+1}
\right)
$$

$$
\frac{1}{9(n-1)}
\left(
6n-4- \frac{\sqrt{\pi}(9+i\sqrt{3})\Gamma(n+1)}{2\cdot 4^n\Gamma(n+1/2)}-\frac{{}_2F_1(1,n+1/2;n+2;4)}{n+1}
\right)
$$

$$
\frac{1}{9(n-1)}
\left(
  6n-4-
(9+i\sqrt{3})\frac{(n!)^2}{2(2n!)}
-\frac{{}_2F_1(1,n+1/2;n+2;4)}{n+1}
\right)
$$


$$
\frac{1}{9(n-1)}
\left(  6n-4-  \frac{9+i\sqrt{3}}{2{2n\choose n\,\,n}}-\frac{{}_2F_1(1,n+1/2;n+2;4)}{n+1}\right)
$$


(the tilde in $\widetilde{{}_2F_1}(1,n+1/2;n+2;4)$ means the
_regularized_ ${}_2F_1$ Gauss hypergeometric function).  The
combinatorical term $\frac{9+i\sqrt{3}}{2{2n\choose n\,\,n}}$ tends to
zero quite quickly, going as $\sqrt{n}4^{-n}$ (from Stirling).  The
hypergeometric term is harder.  First, note that it is evaluated _on_
the cut line (which goes from $1+0i$ to $\infty$ along the real axis);
the hypergeometric function is defined on the cut line as being
continuous from below.  In any event, the imaginary component tends to
zero as $n\longrightarrow\infty$.

Using 

$$
\newcommand{\Fmn}[2]{\operatorname{{}_{#1}F_{#2}}}
\newcommand{\ft}{\Fmn{2}{1}}
\newcommand{\four}[4]{\frac{\Gamma\left(#1\right)\Gamma\left(#2\right)}{\Gamma\left(#3\right)\Gamma\left(#4\right)}}
\ft\left(a,b;c;z\right)
= \four{c}{b-a}{b}{c-a}\left(-z\right)^{-a}\ft\left(a,1-c+a;1-b+a;\frac{1}{z}\right)
+\four{c}{a-b}{a}{c-b}\left(-z\right)^{-b}\ft\left(b,1-c+b;1-a+b;\frac{1}{z}\right)
$$

With $a=1,b=n+1/2,c=n+2,z=4$ we find that

$$
\ft(1,n+\frac{1}{2};n+2;4)=\four{n+2}{n-\frac{1}{2}}{n+\frac{1}{2}}{n+1}\ft(1,-n;\frac{3}{2}-n;\frac{1}{4})
+
\four{n+2}{1/2-n}{1}{3/2}\ft\left(n+\frac{1}{2},-\frac{1}{2};n+\frac{1}{2};\frac{1}{4}\right)
$$

In the above, the first term is
$\frac{n+1}{n-1/2}\ft(1,-n;\frac{3}{2}-n;\frac{1}{4})$ and for the
second we can use the identity $\ft(a,b;b;z)=(1-z)^{-a}$ to get
$\Gamma(2+n)\Gamma(1/2-n)\sqrt{3/\pi}$

I am struggling with $\Gamma(2+n)\Gamma(1/2-n)$.




```{r}
library("hypergeo")
t1 <- function(n){gamma(n+1)/(gamma(n+1/2)*4^n)}
t2 <- function(n){abs(Re(hypergeo(1,n+1/2,n+2,4)/(n+1)))}
n <- 1:20
plot(n,t1(n),log='y')
plot(n,t2(n),log='y')
```



```{r calcarray,cache=TRUE}
options(digits=4)
n <- 40
A <- matrix(NA,n,n)
A[1,] <- 1/factorial(seq_len(n) + 1)
A[,1] <- 1-A[1,]
for(i in 2:n){
  for(j in 2:n){
     A[i,j] <- i/(i+j)*A[i,j-1] + j/(i+j)*A[i-1,j]
  }
}
```

```{r plotA}
matplot(A,type='l',lty=1)
matplot(log(A/(1-A)),type="l",ylim=c(-10,10),lty=1,main="round-off error for p ~= 1")
contour(log(A),asp=1)
contour(log(A/(1-A)),asp=1)
matplot(A + t(A)-1)
N <- seq_len(n-1)
plot(N,A[cbind(N,N+1)])
delta <- A[cbind(N+1,N)]-0.5
plot(N,log(delta),ylim=c(-3,0))
points(N,-log(N)/2-1/sqrt(2),type='l')
approx <- exp(-1/sqrt(2))/sqrt(N)
plot(N,approx/delta)
```
