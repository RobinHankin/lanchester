\begin{tikzpicture}[line cap=round,line join=round,x=3cm,y=3cm]
\newcommand{\state}[2]{$(\textcolor{red}{#1},\textcolor{blue}{#2})$}
\newcommand{\probs}[2]{$\left\langle\textcolor{red}{#1};\textcolor{blue}{#2}\right\rangle$}

\draw[color=gray ,line width=0.5mm] (1,1) -- (0,1) node[sloped, pos=0.5, allow upside down]{\arrowIn};
\draw[color=gray ,line width=0.5mm] (2,1) -- (1,1) node[sloped, pos=0.5, allow upside down]{\arrowIn};
\draw[color=gray ,line width=0.5mm] (1,2) -- (0,2) node[sloped, pos=0.5, allow upside down]{\arrowIn};
\draw[color=black,line width=0.5mm] (2,2) -- (1,2) node[sloped, pos=0.5, allow upside down]{\arrowIn};
\draw[color=gray ,line width=0.5mm] (1,1) -- (1,0) node[sloped, pos=0.5, allow upside down]{\arrowIn};
\draw[color=gray ,line width=0.5mm] (1,2) -- (1,1) node[sloped, pos=0.5, allow upside down]{\arrowIn};
\draw[color=gray ,line width=0.5mm] (2,1) -- (2,0) node[sloped, pos=0.5, allow upside down]{\arrowIn};
\draw[color=black,line width=0.5mm] (2,2) -- (2,1) node[sloped, pos=0.5, allow upside down]{\arrowIn};

\draw[line width=0.1mm] (1.75,1.75) -- (2,2);
\draw[line width=0.1mm] (0.85,1.85) -- (1,2);

\fill[color=gray] (1,1) circle[radius=3pt];
\fill             (2,1) circle[radius=3pt];
\fill             (1,2) circle[radius=3pt];
\fill             (2,2) circle[radius=3pt];

\node at ( 1.6, 0.9) {\probs{x_n}{1-x_n}};
\node at ( 0.3, 1.8) {\probs{\frac{2^{n+3}-n-3}{(n+3)!}}{\frac{4+n-2^{n+3}}{(n+3)!}}};
\node at ( 1.6, 1.7) {{\tiny \probs{x_{n+1}}{1-x_{n+1}}}};

\node at (2.2, 1.1) {\state{3}{n}};
\node at (1.2, 2.1) {\state{2}{n+1}};
\node at (2.0, 2.1) {\state{3}{n+1}};

\node[text=teal] at (1.5, 1.85) {$\frac{n+1}{n+4}$};
\node[text=teal] at (1.85, 1.5) {$\frac{3}{n+4}$};

\end{tikzpicture}
